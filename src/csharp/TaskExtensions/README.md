This code comes from "Samples for Parallel Programming with the .NET Framework".

http://code.msdn.microsoft.com/Samples-for-Parallel-b4b76364/sourcecode?fileId=44488&pathId=1111204181

See license.txt.